<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Voyage Aid AI â€” Planner</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="nav">
    <div class="brand">Voyage Aid AI</div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="itinerary.html">My Itinerary</a>
      <a id="auth-link" href="login.html">Login</a>
    </nav>
  </header>

  <main class="container">
    <section class="card planner-card">
      <h2>Plan Your Journey</h2>

      <label class="field">
        <span>Select city</span>
        <select id="city">
          <option value="Paris">Paris</option>
          <option value="Tokyo">Tokyo</option>
          <option value="Delhi">Delhi</option>
          <option value="Mumbai">Mumbai</option>
          <option value="Kolkata">Kolkata</option>
          <option value="Bangalore">Bangalore</option>
          <option value="Hyderabad">Hyderabad</option>
          <option value="Pune">Pune</option>
          </select>
      </label>

      <label class="field">
        <span>Duration</span>
        <select id="duration" class="duration-select"></select>
      </label>

      <div class="field">
        <span>Your interests</span>
        <div class="chips">
          <label class="chip"><input type="checkbox" value="history" class="fancy-checkbox" /> History</label>
          <label class="chip"><input type="checkbox" value="food" class="fancy-checkbox" /> Food</label>
          <label class="chip"><input type="checkbox" value="adventure" class="fancy-checkbox" /> Adventure</label>
          <label class="chip"><input type="checkbox" value="shopping" class="fancy-checkbox" /> Shopping</label>
          <label class="chip"><input type="checkbox" value="culture" class="fancy-checkbox" /> Culture</label>
        </div>
      </div>

      <div class="field row">
        <label class="switch">
          <input id="snack" type="checkbox" />
          <span class="slider"></span>
        </label>
        <div style="margin-left:12px"><strong>Include optional snack breaks</strong><div class="muted">Breakfast, lunch & dinner are always included</div></div>
      </div>

      <div style="margin-top:18px;">
        <button class="btn-primary" id="generate-btn">Generate Itinerary</button>
      </div>
    </section>
  </main>

  <script src="js/auth.js"></script>
  <script src="js/main.js"></script>
  <script>
    // Enforce login before generating
      document.getElementById('generate-btn').addEventListener('click', ()=> {
      const user = getCurrentUserEmail();
      if (!user) {
        if (confirm("You need to be logged in to generate an itinerary. Go to login?")) {
          window.location.href = "login.html";
        }
        return;
      }
      // collect inputs
      const city = document.getElementById('city').value.trim();
      const rawDuration = document.getElementById('duration').value;
      // normalize duration values to human readable (AI likes "2 days" not "2d")
      const durationMap = {
        '3h': '3 hours',
        '6h': '6 hours',
        '1d': '1 day',
        '2d': '2 days',
        '3-5d': '3-5 days',
        '1w': '7 days'
      };
      const duration = durationMap[rawDuration] || rawDuration;
      const interests = Array.from(document.querySelectorAll('.chips input[type="checkbox"]:checked')).map(i=>i.value);
      const snacks = document.getElementById('snack').checked;
      // save trip data and redirect to itinerary page
      localStorage.setItem('voyage_trip', JSON.stringify({city,duration,interests,snacks}));
      window.location.href = "itinerary.html";
    });

    // update auth link text
    document.addEventListener('DOMContentLoaded', ()=>{
      const user = getCurrentUserEmail();
      const authLink = document.getElementById('auth-link');
      if (user) { authLink.textContent = 'My Account'; authLink.href = 'itinerary.html'; }
    });
  </script>
</body>
</html>
