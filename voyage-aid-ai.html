<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TripTailor — Personalized Itineraries</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220aa;
      --glass: rgba(255,255,255,0.04);
      --accent: #7dd3fc;
      --accent2: #60a5fa;
      --muted: #9aa7b2;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      background: linear-gradient(180deg,#071022 0%, #0d1b2a 60%), radial-gradient(circle at 10% 10%, rgba(96,165,250,0.06), transparent 20%);
      color:#e6eef6;
      padding:28px;
    }
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:#053244}
    h1{margin:0;font-size:20px}
    .container{display:grid;grid-template-columns:360px 1fr;gap:18px}
    .panel{background:var(--card);backdrop-filter: blur(6px);border-radius:12px;padding:16px;box-shadow: 0 6px 20px rgba(2,6,23,0.6);}
    .small{font-size:13px;color:var(--muted)}
    label{display:block;margin-top:12px;font-size:13px;color:#cfe8ff}
    input[type="text"], input[type="email"], input[type="password"], select, textarea{
      width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;margin-top:6px;
    }
    button{margin-top:12px;padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#042235;font-weight:600;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .itinerary{display:flex;flex-direction:column;gap:12px}
    .item{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;display:flex;gap:12px;align-items:flex-start}
    .item .left{width:56px;height:56px;border-radius:8px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-weight:700}
    .item h3{margin:0;font-size:15px}
    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.03);font-size:12px}
    .controls{display:flex;gap:8px;margin-left:auto}
    .link{color:var(--accent);text-decoration:none;font-weight:600;font-size:13px}
    footer{margin-top:16px;color:var(--muted);font-size:13px}
    .flexrow{display:flex;gap:8px;align-items:center}
    .bigtitle{font-size:18px;margin-bottom:6px}
    .preview{max-height:66vh;overflow:auto;padding:6px}
    .hidden{display:none}
    .danger{background:#ff6b6b;color:white}
  </style>
</head>
<body>
  <header>
    <div class="logo">TT</div>
    <div>
      <h1>TripTailor — personalized travel itineraries</h1>
      <div class="small">Enter city, dates, preferences — get a full hourly plan with travel links & media.</div>
    </div>
  </header>

  <div class="container">
    <!-- Left: Signup + inputs -->
    <div class="panel">
      <div class="bigtitle">Account</div>
      <div class="small">Create a free account (demo: stored only in your browser unless backend configured).</div>
      <label>Email
        <input id="email" type="email" placeholder="you@example.com"/>
      </label>
      <label>Password
        <input id="password" type="password" placeholder="Choose a password"/>
      </label>
      <div style="display:flex;gap:8px">
        <button id="signupBtn">Create account</button>
        <button id="loginBtn" style="background:transparent;color:var(--accent);border:1px solid rgba(125,211,252,0.15)">Sign in</button>
      </div>
      <div id="authMsg" class="muted" style="margin-top:8px"></div>

      <hr style="margin:16px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>

      <div class="bigtitle">Plan details</div>

      <label>City (only curated cities show)
        <select id="citySelect">
          <option value="">— Select city —</option>
          <!-- Example pre-fed cities; your backend will control this list -->
          <option value="paris">Paris, France</option>
          <option value="jaipur">Jaipur, India</option>
          <option value="lisbon">Lisbon, Portugal</option>
        </select>
      </label>

      <label>Start location (address or "current")
        <input id="startLoc" type="text" placeholder="Your hotel or 'current'"/>
      </label>

      <label>Start date & time
        <input id="startDateTime" type="datetime-local"/>
      </label>

      <label>Duration (hours)
        <input id="duration" type="number" min="1" value="8"/>
      </label>

      <label>Preferences (pick a theme)
        <select id="theme">
          <option value="balanced">Balanced: popular + local</option>
          <option value="sightseeing">Sightseeing (top attractions)</option>
          <option value="foodie">Food & cafes</option>
          <option value="history">History & museums</option>
          <option value="offbeat">Offbeat / underrated</option>
        </select>
      </label>

      <label>
        Include meals & snack breaks?
        <div class="flexrow" style="margin-top:8px">
          <input id="meals" type="checkbox" checked/> <div class="muted" style="margin-left:6px">Breakfast / Lunch / Dinner + optional snack times</div>
        </div>
      </label>

      <label>Max walking time between stops (minutes)
        <input id="maxWalk" type="number" min="0" value="20"/>
      </label>

      <div style="display:flex;gap:8px">
        <button id="generateBtn">Generate itinerary</button>
        <button id="clearBtn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Clear</button>
      </div>

      <div style="margin-top:12px">
        <div class="muted">Pro tip: city data must be pre-fed on the server for it to appear in the dropdown.</div>
      </div>
    </div>

    <!-- Right: Itinerary preview & editor -->
    <div class="panel">
      <div style="display:flex;align-items:center;gap:12px">
        <div class="bigtitle">Itinerary preview</div>
        <div class="muted">Edit items, skip places, or request an email copy</div>
      </div>

      <div class="preview" id="preview">
        <div id="placeholder" class="muted">No itinerary yet — fill the left form and click <strong>Generate itinerary</strong>.</div>
        <div id="itinerary" class="itinerary hidden"></div>
      </div>

      <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>

      <div style="display:flex;gap:8px;align-items:center">
        <input id="emailCopy" type="email" placeholder="Send itinerary to email (optional)" style="flex:1"/>
        <button id="sendEmailBtn">Send</button>
      </div>

      <div id="status" class="muted" style="margin-top:10px"></div>

      <footer>
        <div>Notes: this front-end uses placeholders for backend calls:</div>
        <ul>
          <li class="muted">POST /api/generate-itinerary → {city, start, startDt, duration, theme, preferences}</li>
          <li class="muted">POST /api/send-email → {email, htmlItinerary}</li>
          <li class="muted">POST /api/auth/signup & /api/auth/login → {email, password}</li>
        </ul>
      </footer>
    </div>
  </div>

  <script>
    // ---------- Demo front-end logic ----------
    const signupBtn = document.getElementById('signupBtn');
    const loginBtn = document.getElementById('loginBtn');
    const authMsg = document.getElementById('authMsg');
    const emailInput = document.getElementById('email');
    const pwdInput = document.getElementById('password');
    const generateBtn = document.getElementById('generateBtn');
    const itineraryEl = document.getElementById('itinerary');
    const placeholder = document.getElementById('placeholder');
    const preview = document.getElementById('preview');
    const sendEmailBtn = document.getElementById('sendEmailBtn');
    const emailCopy = document.getElementById('emailCopy');
    const status = document.getElementById('status');

    // Simple client-side "auth" for demo: store hashed-ish password in localStorage (NOT secure for prod).
    function fakeHash(s){ return btoa(s).slice(0,24); }
    signupBtn.onclick = ()=>{
      const e = emailInput.value.trim(), p = pwdInput.value;
      if(!e||!p){ authMsg.textContent = 'Provide email & password.'; return;}
      localStorage.setItem('trip_user_email', e);
      localStorage.setItem('trip_user_hash', fakeHash(p));
      authMsg.textContent = 'Account created locally (demo). Connect a real backend for secure auth.';
    }
    loginBtn.onclick = ()=>{
      const e = emailInput.value.trim(), p = pwdInput.value;
      if(!e||!p){ authMsg.textContent = 'Provide email & password.'; return;}
      const stored = localStorage.getItem('trip_user_email');
      if(stored===e && localStorage.getItem('trip_user_hash')===fakeHash(p)){
        authMsg.textContent = 'Signed in (demo).';
      } else authMsg.textContent = 'User not found (demo).';
    }

    // Build a sample itinerary (demo). In real app, call /api/generate-itinerary -> get list of stops with {name, durationMins, fee, ytid, lat,lng,amenities}
    function demoGenerateItinerary(params){
      // Sample: will create 6 blocks (mix attractions and meals) with links.
      const samplePlaces = [
        {name:'Central Museum',dur:60,fee:'₹200',yt:'dQw4w9WgXcQ',desc:'Art & local history',lat:28.6139,lng:77.2090},
        {name:'Old Bazaar',dur:75,fee:'Free',yt:'kXYiU_JCYtU',desc:'Markets & local snacks',lat:28.6123,lng:77.2080},
        {name:'Hidden Viewpoint',dur:40,fee:'Free',yt:'oHg5SJYRHA0',desc:'Panoramic city view + photos',lat:28.6110,lng:77.2060},
        {name:'Popular Cathedral',dur:50,fee:'₹100',yt:'3JZ_D3ELwOQ',desc:'Iconic architecture',lat:28.6143,lng:77.2101}
      ];
      const itinerary = [];
      const start = new Date(params.startDt);
      let cur = new Date(start);
      const totalHours = Math.max(1, Number(params.duration));
      const totalMinutes = totalHours * 60;
      let consumed = 0;

      // Add sample meal at start if early morning
      if(params.meals){
        itinerary.push({
          time:cur.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
          type:'meal', name:'Breakfast', dur:30, fee:'Varies', mapUrl: '#'
        });
        cur.setMinutes(cur.getMinutes()+30); consumed += 30;
      }

      // Add places until time runs out
      let i=0;
      while(consumed < totalMinutes && i < samplePlaces.length){
        const p = samplePlaces[i++];
        itinerary.push({
          time:cur.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
          type:'place', name:p.name, dur:p.dur, fee:p.fee, ytid:p.yt, desc:p.desc,
          mapUrl:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.name)}`,
          travelUrl:`https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(params.startLoc||'')}&destination=${encodeURIComponent(p.name)}`
        });
        cur.setMinutes(cur.getMinutes()+p.dur);
        consumed += p.dur;
        // small walk time
        itinerary.push({
          time:cur.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
          type:'walk', name:'Walk / transfer', dur:15, fee:'', mapUrl:'#'
        });
        cur.setMinutes(cur.getMinutes()+15);
        consumed += 15;
      }

      // Add lunch/dinner if time remains
      if(params.meals && consumed < totalMinutes){
        itinerary.push({
          time:cur.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
          type:'meal', name:'Lunch', dur:45, fee:'₹300', mapUrl:'#'
        });
      }
      return itinerary;
    }

    function renderItinerary(list){
      itineraryEl.innerHTML='';
      placeholder.classList.add('hidden');
      itineraryEl.classList.remove('hidden');
      list.forEach((it,idx)=>{
        const div = document.createElement('div'); div.className='item';
        const left = document.createElement('div'); left.className='left';
        left.textContent = it.type==='place'? 'P': (it.type==='meal'?'M':'T');
        const c = document.createElement('div'); c.style.flex='1';
        const h = document.createElement('h3'); h.textContent = `${it.time} — ${it.name}`; c.appendChild(h);
        const d = document.createElement('div'); d.className='small'; d.textContent = it.desc || `${it.dur} mins • ${it.fee || ''}`; c.appendChild(d);
        const chips = document.createElement('div'); chips.className='chips';
        if(it.ytid) {
          const a = document.createElement('a'); a.href=`https://youtu.be/${it.ytid}`; a.target='_blank'; a.className='chip link'; a.textContent='Watch';
          chips.appendChild(a);
        }
        if(it.mapUrl){
          const b = document.createElement('a'); b.href=it.mapUrl; b.target='_blank'; b.className='chip link'; b.textContent='Map';
          chips.appendChild(b);
        }
        c.appendChild(chips);

        const ctrl = document.createElement('div'); ctrl.className='controls';
        const skip = document.createElement('button'); skip.textContent='Skip'; skip.onclick=()=>{ div.style.opacity=0.45; div.style.filter='grayscale(30%)'; };
        const edit = document.createElement('button'); edit.textContent='Edit'; edit.onclick=()=>{
          const newName = prompt('Replace name', it.name); if(newName) h.textContent = `${it.time} — ${newName}`;
        };
        ctrl.appendChild(edit); ctrl.appendChild(skip);

        div.appendChild(left); div.appendChild(c); div.appendChild(ctrl);
        itineraryEl.appendChild(div);
      });
    }

    generateBtn.onclick = async ()=>{
      const city = document.getElementById('citySelect').value;
      const startLoc = document.getElementById('startLoc').value || 'current';
      const startDt = document.getElementById('startDateTime').value || new Date().toISOString();
      const duration = document.getElementById('duration').value;
      const theme = document.getElementById('theme').value;
      const meals = document.getElementById('meals').checked;
      const maxWalk = document.getElementById('maxWalk').value;

      status.textContent = 'Generating itinerary (demo)...';

      // In production: POST to /api/generate-itinerary with the payload and get JSON {itinerary: [...]}
      // const res = await fetch('/api/generate-itinerary', {method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({city,startLoc,startDt,duration,theme,meals,maxWalk})});
      // const data = await res.json();
      // renderItinerary(data.itinerary);

      // DEMO: use local generator
      const demo = demoGenerateItinerary({city,startLoc,startDt,duration,theme,meals});
      renderItinerary(demo);
      status.textContent = 'Itinerary ready (demo). Replace demo backend call with your API endpoint.';
    };

    sendEmailBtn.onclick = async ()=>{
      const target = emailCopy.value.trim();
      if(!target){ status.textContent = 'Enter an email to send to.'; return; }
      status.textContent = 'Preparing email...';
      // Collect itinerary html (demo)
      const html = preview.innerHTML;
      // In production: POST to /api/send-email {to,subject,html} using your email provider
      // Example:
      // await fetch('/api/send-email', {method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({to:target,subject:'Your TripTailor Itinerary',html})});
      status.textContent = 'Email sent (demo). Hook /api/send-email to send real emails.';
    };

    // Clear button
    document.getElementById('clearBtn').onclick = ()=>{
      itineraryEl.innerHTML=''; itineraryEl.classList.add('hidden'); placeholder.classList.remove('hidden'); status.textContent='';
    };
  </script>
</body>
</html>
